"""
快速查看分析结果
"""

import pandas as pd

print("="*100)
print("申银万国研报复刻 - 宏观因子平价分析结果快速查看")
print("="*100)

# 读取汇总结果
summary = pd.read_csv('macro_factor_summary.csv', encoding='utf-8-sig')

print("\n【核心结果】不同宏观变量对应的暴露极值资产")
print("="*100)
print(summary.to_string(index=False))

print("\n" + "="*100)
print("【详细解读】")
print("="*100)

interpretations = {
    '经济增长': """
    • 最高暴露: 标普500 (β=0.135)
      → 经济增长时，美股表现最好
    • 最低暴露: 黄金 (β=-0.125)
      → 经济增长时，黄金表现较差（避险需求下降）
    """,
    
    '流动性': """
    • 最高暴露: 沪深300 (β=0.090)
      → 利率上升时，沪深300相对抗跌
    • 最低暴露: 黄金 (β=-1.805)
      → 利率上升时，黄金大幅下跌（机会成本增加）
      → 这是最显著的暴露差异！
    """,
    
    'CPI': """
    • 最高暴露: 商品 (β=0.328)
      → CPI上升时，商品价格上涨，是通胀对冲首选
    • 最低暴露: 标普500 (β=-0.484)
      → CPI上升时，美股受压制（成本上升、货币紧缩预期）
    """,
    
    'PPI': """
    • 最高暴露: 商品 (β=0.034)
      → PPI上升时，商品表现相对较好
    • 最低暴露: 中证1000 (β=-0.214)
      → PPI上升时，小盘股受损最大（成本压力）
    """,
    
    '信用': """
    • 最高暴露: 商品 (β=0.022)
      → 信用扩张时，商品需求增加
    • 最低暴露: 信用债 (β=-0.010)
      → 信用扩张时，债券收益率上升（价格下跌）
    """
}

for idx, row in summary.iterrows():
    factor = row['宏观因子']
    print(f"\n{factor}:")
    print(interpretations.get(factor, ""))

print("\n" + "="*100)
print("【投资启示】场景平价配置建议")
print("="*100)

scenarios = """
1️⃣  预期经济复苏 → 增配权益（标普500）、减配避险（黄金）
2️⃣  预期通胀上行 → 大幅增配商品、减配权益（尤其标普500）
3️⃣  预期利率上升 → 大幅减配黄金、谨慎对待债券
4️⃣  预期利率下降 → 大幅增配黄金、增配债券
5️⃣  预期信用收缩 → 减配商品、增配债券
6️⃣  预期滞胀环境 → 增配商品（抗通胀）+ 黄金（避险）
"""

print(scenarios)

print("\n" + "="*100)
print("【关键发现】")
print("="*100)

findings = """
✓ 黄金对流动性的暴露度(-1.805)是所有资产中最极端的
  → 黄金是利率风险的最强对冲工具

✓ 商品对通胀(CPI β=0.328, PPI β=0.034)有明确正向暴露
  → 商品是最有效的通胀对冲资产

✓ 标普500对经济增长正暴露(0.135)，但对通胀负暴露(-0.484)
  → 适合"低通胀+经济增长"的黄金时代

✓ 中国权益(沪深300/500/1000)对经济增长普遍负暴露
  → 可能反映样本期内的结构性问题

✓ 不同资产类别在宏观因子上呈现显著差异
  → 为构建"场景平价"组合提供了基础
"""

print(findings)

print("\n" + "="*100)
print("查看完成！详细数据请查看以下文件：")
print("  • macro_factor_exposures.csv  - 完整暴露度矩阵")
print("  • macro_factor_heatmap.png    - 可视化热力图")
print("  • macro_factor_bars.png       - 各因子暴露柱状图")
print("  • macro_factor_radar.png      - 资产暴露雷达图")
print("="*100)
